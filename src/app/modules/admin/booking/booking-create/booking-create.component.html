<div class="absolute inset-0 flex flex-col min-w-0 overflow-hidden bg-gray-50">
  
  <!-- Header -->
  <div class="bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-semibold text-gray-900">Booking Management</h1>
        <p class="text-sm text-gray-500 mt-1">Create and manage customer bookings</p>
      </div>
      <div class="flex gap-3">
        <button (click)="exportData()" 
                class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          Export
        </button>
        <button (click)="saveBooking()" 
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          Save Booking
        </button>
      </div>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="bg-white border-b border-gray-200 px-6 py-3 flex-shrink-0">
    <div class="flex items-center gap-4">
      <div class="flex-1 relative">
        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input 
          type="text" 
          [(ngModel)]="searchTerm"
          placeholder="Search customers..."
          class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
      </div>
      
      <div class="flex gap-2">
        <button (click)="filterType = 'ALL'" 
                [class.bg-blue-100]="filterType === 'ALL'"
                [class.text-blue-700]="filterType === 'ALL'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          All
        </button>
        <button (click)="filterType = 'DISTRIBUTOR'" 
                [class.bg-blue-100]="filterType === 'DISTRIBUTOR'"
                [class.text-blue-700]="filterType === 'DISTRIBUTOR'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          Distributors
        </button>
        <button (click)="filterType = 'DEALER'" 
                [class.bg-blue-100]="filterType === 'DEALER'"
                [class.text-blue-700]="filterType === 'DEALER'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          Dealers
        </button>
        <button (click)="filterType = 'NEW_ACCOUNT'" 
                [class.bg-blue-100]="filterType === 'NEW_ACCOUNT'"
                [class.text-blue-700]="filterType === 'NEW_ACCOUNT'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          New Accounts
        </button>
        <button (click)="filterType = 'ADDAO'" 
                [class.bg-blue-100]="filterType === 'ADDAO'"
                [class.text-blue-700]="filterType === 'ADDAO'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          ADDAO
        </button>
        <button (click)="filterType = 'LOTS'" 
                [class.bg-blue-100]="filterType === 'LOTS'"
                [class.text-blue-700]="filterType === 'LOTS'"
                class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          LOTS
        </button>
      </div>
    </div>
  </div>

  <!-- Summary Cards - Sticky -->
  <div class="sticky top-0 z-20 bg-gray-50 px-6 pt-4 pb-4 flex-shrink-0">
    <div class="grid grid-cols-4 gap-4">
      <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
        <div class="text-sm text-gray-500">Total Customers</div>
        <div class="text-2xl font-semibold text-gray-900 mt-1">{{ filteredCustomers.length }}</div>
      </div>
      <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
        <div class="text-sm text-gray-500">Total Bookings</div>
        <div class="text-2xl font-semibold text-blue-600 mt-1">{{ getGrandTotal() }}</div>
      </div>
      <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
        <div class="text-sm text-gray-500">Active Distributors</div>
        <div class="text-2xl font-semibold text-green-600 mt-1">{{ distributorCount }}</div>
      </div>
      <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
        <div class="text-sm text-gray-500">Active Dealers</div>
        <div class="text-2xl font-semibold text-purple-600 mt-1">{{ dealerCount }}</div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex-1 overflow-hidden px-6 pb-4">
    <div class="bg-white rounded-lg border border-gray-200 h-full overflow-auto">
      <table class="min-w-full divide-y divide-gray-200 relative">
        <thead class="bg-gray-50 sticky top-0 z-10">
          <tr>
            <th class="sticky left-0 z-30 bg-gray-50 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-300 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]">
              Customer
            </th>
            <th *ngFor="let cat of productCategories" 
                class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-300 min-w-[70px] bg-gray-50">
              {{ cat.label }}
            </th>
            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-blue-50 border-r border-gray-300 min-w-[80px]">
              Total
            </th>
            <th class="sticky right-0 z-30 bg-gray-50 px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider shadow-[-2px_0_5px_-2px_rgba(0,0,0,0.1)]">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let customer of filteredCustomers" 
              class="hover:bg-gray-50 transition-colors"
              [class.bg-yellow-50]="customer.type === 'DISTRIBUTOR'"
              [class.bg-green-50]="customer.type === 'NEW_ACCOUNT'"
              [class.bg-purple-50]="customer.type === 'ADDAO'">
            <td class="sticky left-0 z-20 px-6 py-2 whitespace-nowrap border-r border-gray-300 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"
                [class.bg-yellow-50]="customer.type === 'DISTRIBUTOR'"
                [class.bg-green-50]="customer.type === 'NEW_ACCOUNT'"
                [class.bg-purple-50]="customer.type === 'ADDAO'"
                [class.bg-white]="customer.type === 'DEALER' || customer.type === 'LOTS'">
              <div class="flex items-center">
                <div>
                  <div class="text-sm font-medium text-gray-900">{{ customer.name }}</div>
                  <div class="text-xs text-gray-500">
                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium"
                          [class.bg-yellow-100]="customer.type === 'DISTRIBUTOR'"
                          [class.text-yellow-800]="customer.type === 'DISTRIBUTOR'"
                          [class.bg-blue-100]="customer.type === 'DEALER'"
                          [class.text-blue-800]="customer.type === 'DEALER'"
                          [class.bg-green-100]="customer.type === 'NEW_ACCOUNT'"
                          [class.text-green-800]="customer.type === 'NEW_ACCOUNT'"
                          [class.bg-purple-100]="customer.type === 'ADDAO'"
                          [class.text-purple-800]="customer.type === 'ADDAO'"
                          [class.bg-gray-100]="customer.type === 'LOTS'"
                          [class.text-gray-800]="customer.type === 'LOTS'">
                      {{ customer.type }}
                    </span>
                    <span *ngIf="customer.isWAP" class="ml-1 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800">
                      WAP
                    </span>
                  </div>
                  <div *ngIf="customer.priority" class="text-xs text-orange-600 mt-1">
                    <svg class="inline w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6z" />
                    </svg>
                    {{ customer.priority }}
                  </div>
                </div>
              </div>
            </td>
            <td *ngFor="let cat of productCategories" class="px-2 py-2 border-r border-gray-300">
              <input 
                type="number" 
                min="0"
                [value]="getQuantity(customer.name, cat.name)"
                (input)="updateQuantity(customer.name, cat.name, $any($event.target).value)"
                class="w-full px-2 py-1.5 text-center border-0 focus:ring-1 focus:ring-blue-500 text-sm bg-transparent"
                placeholder="0">
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-center bg-blue-50 border-r border-gray-300">
              <span class="inline-flex items-center px-2 py-1 text-sm font-semibold text-blue-800">
                {{ getTotalForCustomer(customer.name) }}
              </span>
            </td>
            <td class="sticky right-0 z-20 px-4 py-2 whitespace-nowrap text-center shadow-[-2px_0_5px_-2px_rgba(0,0,0,0.1)]"
                [class.bg-yellow-50]="customer.type === 'DISTRIBUTOR'"
                [class.bg-green-50]="customer.type === 'NEW_ACCOUNT'"
                [class.bg-purple-50]="customer.type === 'ADDAO'"
                [class.bg-white]="customer.type === 'DEALER' || customer.type === 'LOTS'">
              <button (click)="clearBooking(customer.name)" 
                      class="text-red-600 hover:text-red-900 text-sm font-medium">
                Clear
              </button>
            </td>
          </tr>
        </tbody>
        <tfoot class="bg-gray-100">
          <tr>
            <td class="sticky left-0 z-20 bg-gray-100 px-6 py-3 text-sm font-semibold text-gray-900 border-r border-gray-300 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]">
              Category Totals
            </td>
            <td *ngFor="let cat of productCategories" class="px-3 py-3 text-center border-r border-gray-300">
              <span class="inline-flex items-center px-2 py-1 text-sm font-semibold bg-gray-200 text-gray-800">
                {{ getTotalForCategory(cat.name) }}
              </span>
            </td>
            <td class="px-3 py-3 text-center bg-blue-100 border-r border-gray-300">
              <span class="inline-flex items-center px-3 py-1 text-base font-bold bg-blue-600 text-white">
                {{ getGrandTotal() }}
              </span>
            </td>
            <td class="sticky right-0 z-20 bg-gray-100 px-4 py-3 shadow-[-2px_0_5px_-2px_rgba(0,0,0,0.1)]"></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>